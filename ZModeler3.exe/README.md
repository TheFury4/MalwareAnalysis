
# ZModel3.exe Malware Analysis

## Summary

 **Main object - ZModeler3.exe**
 - **md5:** 6b0f570da3eac953963b4c8ec52525e5
 - **sha1:** 2ad8cc75755bfade7201e5b3d81a32758751f798
 - **sha256:** 895f6bcde10553b1a684655ea82f81129258104c22c849867715a78e724b6aad

**Dropped executable file**
 - **sha256:** C:\%user%\svchost.exe 4df857b0c45fd16af3eef6e29921ddece478d84cc9c48b634631c7599827f0ca
 - **sha256:** C:\%user%\AppData\Local\Temp\data\ZModeler3.exe bf99ce07768933217b878f730c057a80f1cad43d452080f13a42c7dc7c44090f

*%user% = generic term to indicate the user who started the main .exe*


## Analysis

1. **Program Execution**
   - ZModel3.exe spawned a new instance in a different folder.

2. **Scheduled Task Creation**
   - Created a scheduled task using schtasks.exe to run svchost.exe (a fake clone of the original microsoft process) every minute.

3. **Suspicious Process Execution**
   - Executed svchost.exe, a commonly used name by malware (and indeed it is a malware) to disguise itself.

4. **Registry Modification**
   - Modified ProxyBypass value in the ZoneMap registry key.



## What I have found
I maneged to extract the malware configuration and track all the changes that the 'svchost.exe' performed, the process will firstly download on your PC a trojan (RAT) named xWorm and them it will modify some [registry keys](https://learn.microsoft.com/en-us/troubleshoot/windows-server/performance/windows-registry-advanced-users) to start the connection to the Master at every startup

### What is xWorm?
XWorm is a remote access trojan (RAT) sold as a malware-as-a-service. It possesses an extensive hacking toolset and is capable of gathering private information and files from the infected computer, hijacking MetaMask and Telegram accounts, and tracking user activity.

### The Configuration:

    {
      "C2": "209.25.140.181:32644",
      "Keys": {
              "AES": "<123456789>"
      },
      "Options": {
              "Splitter": "Xwormmm",
              "Sleep time": "5",
              "USB drop name": "USB.exe",
              "Mutex": "Rd0dbJjw2s3VxJQ0"
      }
    }

###  Registry activity

**(PID) Process: (2184) ZModeler3.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: ProxyBypass
Value: 1

**(PID) Process: (2184) ZModeler3.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: IntranetName
Value: 1

**(PID) Process: (2184) ZModeler3.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: UNCAsIntranet
Value: 1

**(PID) Process: (2184) ZModeler3.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: AutoDetect
Value: 0

**(PID) Process: (2268) svchost.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: ProxyBypass
Value: 1

**(PID) Process: (2268) svchost.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: IntranetName
Value: 1

**(PID) Process: (2268) svchost.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: UNCAsIntranet
Value: 1

**(PID) Process: (2268) svchost.exe**
Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap
Operation: write
Name: AutoDetect
Value: 0

### Peristency
[Techniques details](https://attack.mitre.org/techniques/T1547/001/)
Operation: WRITE
Device: DISK_FILE_SYSTEM
Object: UNKNOWN TYPE
Name: C:\Users\admin\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup\svchost.lnk
Status: 0x00000000
Created: NONE

**It also create a task to run the process every minute**

    "C:\Windows\System32\schtasks.exe" /create /f /sc minute /mo 1 /tn "svchost" /tr "C:\Users\admin\svchost.exe"

1.  **C:\Windows\System32\schtasks.exe:** This part of the command indicates the full path to the `schtasks.exe` executable in the Windows operating system. This program is used to create, modify, delete, or view scheduled tasks in the system.
    
2.  **/create:** This option indicates that you are creating a new scheduled task.
    
3.  **/f:** This parameter indicates to overwrite the existing task, if present, without prompting for confirmation.
    
4.  **/sc minute:** This option specifies that the frequency of task execution is every minute.
    
5.  **/mo 1:** This parameter specifies the recurrence interval, in this case, every 1 minute.
    
6.  **/tn "svchost":** name of the scheduled task, which is "svchost."
    
7.  **/tr "C:\Users\admin\svchost.exe":** This parameter specifies the path to the program or script that will be executed when the scheduled task is triggered. In this case, it points to "C:\Users\admin\svchost.exe."


## Contributing

- Contributions and feedback are welcome.
- Open an issue or submit a pull request to enhance the analysis.

## Disclaimer

This analysis is for educational purposes only. Do not execute code or run samples without proper understanding and precautions.
